{"version":3,"sources":["demo3.js"],"names":["createLandscape","params","scene","renderer","camera","terrain","container","document","querySelector","width","window","innerWidth","height","innerHeight","mouse","x","y","xDamped","yDamped","isMobile","orientation","sky","THREE","Sky","scale","setScalar","material","uniforms","turbidity","value","rayleigh","luminance","mieCoefficient","mieDirectionalG","add","sunSphere","Mesh","SphereBufferGeometry","MeshBasicMaterial","color","visible","theta","Math","PI","phi","position","cos","sin","z","sunPosition","copy","resize","aspect","updateProjectionMatrix","setSize","onInputMove","e","preventDefault","type","clientX","clientY","changedTouches","render","requestAnimationFrame","lerp","time","performance","now","scroll","map","distortCenter","roadWidth","start1","stop1","start2","stop2","start","end","amt","Scene","fogColor","Color","background","fog","Fog","PerspectiveCamera","ambientLight","AmbientLight","WebGLRenderer","canvas","antialias","setPixelRatio","devicePixelRatio","sceneSetup","geometry","PlaneBufferGeometry","pallete","speed","maxHeight","ShaderMaterial","UniformsUtils","merge","ShaderLib","basic","vertexShader","getElementById","textContent","fragmentShader","wireframe","rotation","TextureLoader","load","palleteImage","texture","needsUpdate","addEventListener","passive","init","getRandomNumber","min","max","random","animateTitles","overlay","title","charming","titleLetters","Array","from","querySelectorAll","TweenMax","to","ease","Quad","easeOut","opacity","set","staggerTo","Expo","startAt","rotationX","subtitle","glitch","el","cycles","setTimeout","loop","this","timeout","lettersSet","sort","a","b","slice","length","i","len"],"mappings":"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","file":"demo3.js","sourcesContent":["createLandscape({\r\n  palleteImage:'img/pallete.png'\r\n})\r\n\r\nfunction createLandscape(params){\r\n\r\n  var container = document.querySelector(\".landscape\")\r\n  var width = window.innerWidth;\r\n  var height = window.innerHeight;\r\n\r\n  var scene, renderer, camera;\r\n  var terrain;\r\n\r\n  var mouse = { x:0, y:0, xDamped:0, yDamped:0 };\r\n  var isMobile = typeof window.orientation !== 'undefined'\r\n\r\n  init();\r\n\r\n  function init(){\r\n\r\n    sceneSetup();\r\n    sceneElements();\r\n    sceneTextures();\r\n    render();\r\n\r\n    if(isMobile)\r\n      window.addEventListener(\"touchmove\", onInputMove, {passive:false})\r\n    else\r\n      window.addEventListener(\"mousemove\", onInputMove)\r\n    \r\n    window.addEventListener(\"resize\", resize)\r\n    resize()\r\n  }\r\n\r\n  function sceneSetup(){\r\n    scene = new THREE.Scene();\r\n    var fogColor = new THREE.Color( 0x333333 )\r\n    scene.background = fogColor;\r\n    scene.fog = new THREE.Fog(fogColor, 0, 400);\r\n\r\n    \r\n    sky()\r\n\r\n    camera = new THREE.PerspectiveCamera(60, width / height, .1, 10000);\r\n    camera.position.y = 8;\r\n    camera.position.z = 4;\r\n    \r\n    ambientLight = new THREE.AmbientLight(0xffffff, 1);\r\n    scene.add(ambientLight)\r\n    \r\n\r\n    renderer = new THREE.WebGLRenderer( {\r\n      canvas:container,\r\n      antialias:true\r\n    } );\r\n    renderer.setPixelRatio = devicePixelRatio;\r\n    renderer.setSize(width, height);\r\n    \r\n\r\n  }\r\n\r\n  function sceneElements(){\r\n\r\n    var geometry = new THREE.PlaneBufferGeometry(100, 400, 400, 400);\r\n\r\n    var uniforms = {\r\n      time: { type: \"f\", value: 0.0 },\r\n      scroll: { type: \"f\", value: 0.0 },\r\n      distortCenter: { type: \"f\", value: 0.1 },\r\n      roadWidth: { type: \"f\", value: 0.5 },\r\n      pallete:{ type: \"t\", value: null},\r\n      speed: { type: \"f\", value: 3 },\r\n      maxHeight: { type: \"f\", value: 10.0 },\r\n      color:new THREE.Color(1, 1, 1)\r\n    }\r\n    \r\n    var material = new THREE.ShaderMaterial({\r\n      uniforms: THREE.UniformsUtils.merge([ THREE.ShaderLib.basic.uniforms, uniforms ]),\r\n      vertexShader: document.getElementById( 'custom-vertex' ).textContent,\r\n      fragmentShader: document.getElementById( 'custom-fragment' ).textContent,\r\n      wireframe:false,\r\n      fog:true\r\n    });\r\n\r\n    terrain = new THREE.Mesh(geometry, material);\r\n    terrain.position.z = -180;\r\n    terrain.rotation.x = -Math.PI / 2\r\n\r\n    scene.add(terrain)\r\n\r\n  }\r\n\r\n  function sceneTextures(){\r\n\r\n    // pallete\r\n    new THREE.TextureLoader().load( params.palleteImage, function(texture){\r\n      terrain.material.uniforms.pallete.value = texture;\r\n      terrain.material.needsUpdate = true;\r\n    });\r\n  }\r\n\r\n  function sky(){\r\n    sky = new THREE.Sky();\r\n    sky.scale.setScalar( 450000 );\r\n    sky.material.uniforms.turbidity.value = 13;\r\n    sky.material.uniforms.rayleigh.value = 1.2;\r\n    sky.material.uniforms.luminance.value = 1;\r\n    sky.material.uniforms.mieCoefficient.value = 0.1;\r\n    sky.material.uniforms.mieDirectionalG.value = 0.58;\r\n    \r\n    scene.add( sky );\r\n\r\n    sunSphere = new THREE.Mesh(\r\n      new THREE.SphereBufferGeometry( 20000, 16, 8 ),\r\n      new THREE.MeshBasicMaterial( { color: 0xffffff } )\r\n    );\r\n    sunSphere.visible = false;\r\n    scene.add( sunSphere );\r\n    \r\n    var theta = Math.PI * ( -0.002 );\r\n    var phi = 2 * Math.PI * ( -.25 );\r\n\r\n    sunSphere.position.x = 400000 * Math.cos( phi );\r\n    sunSphere.position.y = 400000 * Math.sin( phi ) * Math.sin( theta );\r\n    sunSphere.position.z = 400000 * Math.sin( phi ) * Math.cos( theta );\r\n    \r\n    sky.material.uniforms.sunPosition.value.copy( sunSphere.position );\r\n  }\r\n\r\n  function resize(){\r\n    width = window.innerWidth\r\n    height = window.innerHeight\r\n    camera.aspect = width / height;\r\n    camera.updateProjectionMatrix();\r\n\r\n    renderer.setSize( width, height );\r\n  }\r\n\r\n  function onInputMove(e){\r\n    e.preventDefault();\r\n    \r\n    var x, y\r\n    if(e.type == \"mousemove\"){\r\n      x = e.clientX;\r\n      y = e.clientY;\r\n    }else{\r\n      x = e.changedTouches[0].clientX\r\n      y = e.changedTouches[0].clientY\r\n    }\r\n    \r\n    mouse.x = x;\r\n    mouse.y = y;\r\n    \r\n  }\r\n\r\n  function render(){\r\n    requestAnimationFrame(render)\r\n\r\n\r\n    // damping mouse for smoother interaction\r\n    mouse.xDamped = lerp(mouse.xDamped, mouse.x, 0.1);\r\n    mouse.yDamped = lerp(mouse.yDamped, mouse.y, 0.1);\r\n\r\n    \r\n    var time = performance.now() * 0.001\r\n    terrain.material.uniforms.time.value = time\r\n    terrain.material.uniforms.scroll.value = time + map(mouse.yDamped, 0, height, 0, 4);\r\n    terrain.material.uniforms.distortCenter.value = Math.sin(time) * 0.1;\r\n    terrain.material.uniforms.roadWidth.value = map(mouse.xDamped, 0, width, 1, 4.5);\r\n\r\n    camera.position.y = map(mouse.yDamped, 0, height, 4, 11);\r\n\r\n    renderer.render(scene, camera)\r\n\r\n  }\r\n\r\n  function map (value, start1, stop1, start2, stop2) {\r\n    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1))\r\n  }\r\n\r\n  function lerp (start, end, amt){\r\n    return (1 - amt) * start + amt * end\r\n  }\r\n}\r\n\r\nconst getRandomNumber = (min, max) => (Math.random() * (max - min) + min);\r\n\r\nanimateTitles();\r\n\r\nfunction animateTitles() {\r\n  const overlay = document.querySelector('.overlay'); \r\n  const title = document.querySelector('.content__title');\r\n  charming(title);\r\n  const titleLetters = Array.from(title.querySelectorAll('span'));\r\n\r\n  TweenMax.to(overlay, 2, {\r\n    ease: Quad.easeOut,\r\n    opacity: 0\r\n  });\r\n\r\n  TweenMax.set(titleLetters, {opacity: 0});\r\n  TweenMax.staggerTo(titleLetters, 1.5, {\r\n    ease: Expo.easeOut,\r\n    startAt: {rotationX: -100, z: -1000},\r\n    opacity: 1,\r\n    rotationX: 0,\r\n    z: 0\r\n  }, 0.1);\r\n\r\n  const subtitle = document.querySelector('.content__subtitle');\r\n  TweenMax.set(subtitle, {opacity: 0});\r\n  TweenMax.to(subtitle, 1.5, {\r\n    ease: Expo.easeOut,\r\n    startAt: {y: 30},\r\n    opacity: 1,\r\n    y: 0\r\n  });\r\n\r\n  const glitch = (el,cycles) => {\r\n    if ( cycles === 0 || cycles > 3 ) return;\r\n    TweenMax.set(el, {\r\n      x: getRandomNumber(-20,20), \r\n      y: getRandomNumber(-20,20),\r\n      color: ['#f4d339','#df003f','#111111'][cycles-1]\r\n    });\r\n    setTimeout(() => {\r\n      TweenMax.set(el, {x: 0, y: 0, color: '#fff'});\r\n      glitch(el, cycles-1);\r\n    }, getRandomNumber(20,100));\r\n  };\r\n\r\n  const loop = (startAt) => {\r\n    this.timeout = setTimeout(() => {\r\n        const titleLettersShuffled = titleLetters.sort((a,b) => 0.5 - Math.random());\r\n        const lettersSet = titleLettersShuffled.slice(0, getRandomNumber(1,titleLetters.length+1));\r\n        for (let i = 0, len = lettersSet.length; i < len-1; ++i) {\r\n          glitch(lettersSet[i], 3);\r\n        }\r\n        loop();\r\n    }, startAt || getRandomNumber(500, 3000));\r\n  }\r\n  loop(1500);\r\n}"]}